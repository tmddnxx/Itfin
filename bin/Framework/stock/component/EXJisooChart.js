!async function(){await afc.import("Framework/stock/component/BaseChart.js"),(EXJisooChart=class extends BaseChart{constructor(){super(),this.frwName="stock",this.delegator=null,this.divisionVal=1,this.preScale=1,this.rateVal=1,this.zoomState=0,this.lastDist=0,this.scollSX=0,this.scollEX=0,this.speed=10,this.mStartTime=0,this.mOldTime=0,this.mStartX=0,this.mEndX=0,this.mScrollLR=!1,this.timer=null,this.offset=0,this.startIdx=0,this.startLineX=0,this.endIdx=0,this.BAR_CNT=50,this.prdCls=0,this.dateformatFunc=[afc.formatDate,afc.formatDate,afc.formatMonth,null,null,afc.formatDateTime,null,afc.formatTic],this.dateformat=this.dateformatFunc[this.prdCls],this.dashType=[1.5,4],this.TEXT_SIZE="16px",this.defColorObj={BACK:StockColor.BACK,TEXT:StockColor.TEXT,DOT:StockColor.DOT,DIVLINE:StockColor.DIVLINE,LINE:StockColor.LINE,START:StockColor.START,END:StockColor.END},this.colorObj={BACK:StockColor.BACK,TEXT:StockColor.TEXT,DOT:StockColor.DOT,DIVLINE:StockColor.DIVLINE,LINE:StockColor.LINE,START:StockColor.START,END:StockColor.END},this.touchEvent=null,this.isFirst=!0,this.ROW_CNT=14,this.AM_R_WIDTH=100,this.AM_L_WIDTH=0,this.MAX_BAR_W=80,this.DEF_BAR_W=8,this.BAR_TERM=0,this.upGrpMaxAm=0,this.upGrpMinAm=0,this.pos={cavasW:0,cavasH:0,grpW:0,grpEX:0,dtXs:[],amYs:[],amPad:0,txtY:0,upGrpSY:0,upDtY:0,upGrpEY:0,upGrpH:0,upRateH:0,barW:this.DEF_BAR_W,barTot:0},this.compLeft=0,this.middleX=0,this.data=[]}}).CONTEXT={tag:'<div data-base="EXJisooChart" data-class="EXJisooChart" class="EXJisooChart-Style" >            <canvas width="640px" height="400px"></canvas>            <span class="chart-title"></span>\t        <div class="chart-vline" style="display:none;"></div>\t\t\t<div class="chart-hline" style="display:none;"></div>\t\t\t<div class="chart-zoomLay"><div class="chart-zoomIn" >+</div><div class="chart-zoomOut">-</div></div>            <div class="chart-info" style="display:none;"></div>\t\t</div>',defStyle:{width:"640px",height:"400px"},events:[]},EXJisooChart.prototype.init=function(t,s){BaseChart.prototype.init.call(this,t,s),this.isFirst=!0,this.title=this.element.children[1],this.longXdiv=this.element.children[2],this.longYdiv=this.element.children[3],this.zoomDiv=this.element.children[4],this.zoomInDiv=this.zoomDiv.children[0],this.zoomOutDiv=this.zoomDiv.children[1],this.infoDiv=this.element.children[5],this.initEvent()},EXJisooChart.prototype.initEvent=function(){this.setTouchEvent(),this.setZoomEvent()},EXJisooChart.prototype.updatePosition=function(t,s){BaseChart.prototype.updatePosition.call(this,t,s),this.calcPosition(this.eleW,this.eleH),this.updateGraph()},EXJisooChart.prototype.setZoomEvent=function(){var s=this;$(this.zoomInDiv).bind(AEvent.ACTION_UP,function(t){s.data&&0!=s.data.length&&(1!=s.zoomState&&(s.rateVal=1,s.zoomState=1),s.rateVal=parseFloat(s.rateVal)+.01,s.zoomInOut())}),$(this.zoomOutDiv).bind(AEvent.ACTION_UP,function(t){s.data&&0!=s.data.length&&(2!=s.zoomState&&(s.rateVal=1,s.zoomState=2),s.rateVal=parseFloat(s.rateVal)-.01,s.zoomInOut())})},EXJisooChart.prototype.setDelegator=function(t){this.delegator=t},EXJisooChart.prototype.setDivisionVal=function(t){this.divisionVal=t},EXJisooChart.prototype.setColors=function(t){for(var s in t)t.hasOwnProperty(s)&&(this["COLOR_"+s]=t[s])},EXJisooChart.prototype.setTitle=function(t){this.title.textContent=t},EXJisooChart.prototype.getTitle=function(){return this.title.textContent},EXJisooChart.prototype.calcPosition=function(t,s){this.pos.cavasW=t,this.pos.cavasH=s,this.pos.grpEX=t-this.AM_R_WIDTH,this.pos.grpW=this.pos.grpEX-this.AM_L_WIDTH,this.pos.amPad=t-5,this.pos.dtXs=[this.AM_L_WIDTH+.25*this.pos.grpW,this.AM_L_WIDTH+.5*this.pos.grpW,this.AM_L_WIDTH+.75*this.pos.grpW],this.pos.upGrpSY=s/this.ROW_CNT,this.pos.txtY=this.pos.upGrpSY/2,this.pos.upGrpEY=13*this.pos.upGrpSY,this.pos.upGrpH=this.pos.upGrpEY-this.pos.upGrpSY,this.pos.upDtY=this.pos.upGrpEY+this.pos.txtY,this.pos.amYs=[this.pos.upGrpSY,4*this.pos.upGrpSY,7*this.pos.upGrpSY,10*this.pos.upGrpSY,13*this.pos.upGrpSY],this.TEXT_SIZE=t<s?.03*this.pos.cavasW+"px":.03*this.pos.cavasH+"px",this.pos.barTot=this.pos.grpW/this.BAR_CNT,this.pos.barW=this.pos.barTot-this.BAR_TERM,this.startLineX=this.pos.grpEX},EXJisooChart.prototype.setData=function(t,s){if(this.resetData(),!s){var i=t[0].length;s=new Array;for(var o=0;o<i;o++)s.push(o)}for(var a,o=0;o<t.length;o++)a=t[o],this.data.push([a[s[0]],a[s[1]]/this.divisionVal,a[s[2]]/this.divisionVal,a[s[3]]/this.divisionVal,a[s[4]]/this.divisionVal,a[s[5]]/this.divisionVal,a[s[6]]/this.divisionVal]);this.updateGraph()},EXJisooChart.prototype.setIsFirst=function(t){this.isFirst=t},EXJisooChart.prototype.getIsFirst=function(){return this.isFirst},EXJisooChart.prototype.setPrdCls=function(t){this.prdCls=t,this.dateformat=this.dateformatFunc[this.prdCls]},EXJisooChart.prototype.resetData=function(){this.preScale=1,this.rateVal=1,this.zoomState=0,this.lastDist=0,this.scollSX=0,this.scollEX=0,this.speed=0,this.mStartTime=0,this.mOldTime=0,this.mStartX=0,this.mEndX=0,this.mScrollLR=!1,this.timer=null,this.offset=0,this.startIdx=0,this.endIdx=0,this.pos.barTot=this.pos.grpW/this.BAR_CNT,this.pos.barW=this.pos.barTot-this.BAR_TERM,this.isFirst=!0,this.upGrpMaxAm=0,this.upGrpMinAm=0,this.nextIqryDate="",this.data=[],this.ctx.clearRect(0,0,this.pos.cavasW,this.pos.cavasH),this.drawBackLine()},EXJisooChart.prototype.setMaxMin=function(){this.upGrpMaxAm=0,this.upGrpMinAm=Number.MAX_VALUE;for(var t,s=this.startIdx;s<this.endIdx;s++)(t=this.data[s][4])>this.upGrpMaxAm&&(this.upGrpMaxAm=t),t<this.upGrpMinAm&&(this.upGrpMinAm=t);this.pos.upRateH=(this.pos.upGrpEY-this.pos.upGrpSY)/(this.upGrpMaxAm-this.upGrpMinAm)},EXJisooChart.prototype.draw=function(){this.ctx.clearRect(0,0,this.pos.cavasW,this.pos.cavasH),this.ctx.font=this.TEXT_SIZE+" '"+this.FONT_FAMILY+"'",this.ctx.textBaseline="middle",this.drawBackLine(),this.drawGraph()},EXJisooChart.prototype.drawBackLine=function(){this.ctx.beginPath(),this.ctx.lineWidth=1.5,this.ctx.strokeStyle=this.colorObj.DOT;for(var t=0;t<5;t++)this.drawDashedLine(this.AM_L_WIDTH+0,this.pos.amYs[t],this.pos.grpEX,this.pos.amYs[t],this.dashType);for(t=0;t<3;t++)this.drawDashedLine(this.pos.dtXs[t]-1,0,this.pos.dtXs[t],this.pos.upGrpEY,this.dashType);this.ctx.stroke(),this.ctx.closePath()},EXJisooChart.prototype.drawGraph=function(){if(0!=this.data.length){var t=this.pos.grpEX,s=(this.ctx.fillStyle=this.colorObj.TEXT,this.ctx.textAlign="center",this.data[parseInt(.75*this.BAR_CNT)+this.startIdx]),i=this.data[parseInt(.5*this.BAR_CNT)+this.startIdx],o=this.data[parseInt(.25*this.BAR_CNT)+this.startIdx];s&&this.ctx.fillText(this.dateformat(s[0]),this.pos.dtXs[0],this.pos.upDtY),i&&this.ctx.fillText(this.dateformat(i[0]),this.pos.dtXs[1],this.pos.upDtY),o&&this.ctx.fillText(this.dateformat(o[0]),this.pos.dtXs[2],this.pos.upDtY),this.AM_R_WIDTH&&(this.ctx.textAlign="right",this.ctx.fillText(this._getDecimalValue(this.upGrpMaxAm.toFixed(2)),this.pos.amPad,this.pos.amYs[0]),this.ctx.fillText(this._getDecimalValue((this.upGrpMaxAm-.25*(this.upGrpMaxAm-this.upGrpMinAm)).toFixed(2)),this.pos.amPad,this.pos.amYs[1]),this.ctx.fillText(this._getDecimalValue((this.upGrpMaxAm-.5*(this.upGrpMaxAm-this.upGrpMinAm)).toFixed(2)),this.pos.amPad,this.pos.amYs[2]),this.ctx.fillText(this._getDecimalValue((this.upGrpMaxAm-.75*(this.upGrpMaxAm-this.upGrpMinAm)).toFixed(2)),this.pos.amPad,this.pos.amYs[3]),this.ctx.fillText(this._getDecimalValue(this.upGrpMinAm.toFixed(2)),this.pos.amPad,this.pos.amYs[4])),this.ctx.beginPath(),this.ctx.lineJoin="bevel",this.ctx.lineCap="round",this.ctx.strokeStyle=this.colorObj.LINE,this.ctx.moveTo(t,this.pos.upGrpEY),this.ctx.lineTo(t,this.pos.upGrpSY+(this.upGrpMaxAm-this.data[this.startIdx][4])*this.pos.upRateH),this.ctx.stroke();for(var a=this.startIdx+1;a<this.endIdx;a++)t-=this.pos.barW,this.ctx.lineTo(t,this.pos.upGrpSY+(this.upGrpMaxAm-this.data[a][4])*this.pos.upRateH);this.ctx.stroke(),this.ctx.lineTo(t,this.pos.upGrpEY);s=this.ctx.createLinearGradient(0,this.pos.upGrpSY,0,this.pos.upGrpEY);s.addColorStop(0,this.colorObj.START),s.addColorStop(1,this.colorObj.END),this.ctx.fillStyle=s,this.ctx.fill(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.lineWidth=2,this.ctx.strokeStyle=this.colorObj.DIVLINE,this.ctx.moveTo(this.pos.grpEX,0),this.ctx.lineTo(this.pos.grpEX,this.pos.cavasH),this.ctx.stroke(),this.ctx.closePath()}},EXJisooChart.prototype.setBackLineColor=function(t,s){this.colorObj.DOT=t,s&&this.updatePosition($(this.element).width(),$(this.element).height())},EXJisooChart.prototype.setTextColor=function(t,s){this.colorObj.TEXT=t,s&&this.updatePosition($(this.element).width(),$(this.element).height())},EXJisooChart.prototype.setUpColor=function(t,s){this.COLOR_PLUS=t,s&&this.updatePosition($(this.element).width(),$(this.element).height())},EXJisooChart.prototype.setDownColor=function(t,s){this.COLOR_MINUS=t,s&&this.updatePosition($(this.element).width(),$(this.element).height())},EXJisooChart.prototype.isExistNextData=function(){return!(this.startIdx+this.BAR_CNT+1>this.data.length)},EXJisooChart.prototype.getOffset=function(){var t=this.startIdx+this.BAR_CNT+1;t>this.data.length?this.endIdx=this.data.length:this.endIdx=t},EXJisooChart.prototype.barWidthChange=function(){this.pos.barTot=this.pos.barW+this.BAR_TERM,this.BAR_CNT=parseInt(this.pos.grpW/this.pos.barTot,10),this.startLineX=this.pos.grpEX},EXJisooChart.prototype.scrollLToR=function(t){this.isExistNextData()?(this.startIdx+=t,this.updateGraph()):this.getOffset()},EXJisooChart.prototype.scrollRToL=function(t){this.data.length<1?this.getOffset():(this.startIdx-=t,this.startIdx<0&&(this.startIdx=0),this.updateGraph())},EXJisooChart.prototype.updateGraph=function(){this.isExistNextData()||!this.nextIqryDate?(this.getOffset(),this.setMaxMin(),this.draw()):this.delegator&&this.delegator.callNextData(this.nextIqryDate)},EXJisooChart.prototype.zoomInOut=function(){this.preScale!=this.rateVal&&(this.preScale=this.rateVal,this.pos.barW*=this.preScale,this.pos.barW<this.DEF_BAR_W?this.pos.barW=this.DEF_BAR_W:this.pos.barW>this.MAX_BAR_W?this.pos.barW=this.MAX_BAR_W:(this.barWidthChange(),this.updateGraph()))},EXJisooChart.prototype.drawLongTabData=function(t){var s,t=t-this._getCompLeft(),t=this.pos.grpEX-t,i=parseInt(t/this.pos.barTot),t=(t%this.pos.barTot>this.pos.barTot&&(i+=1),this.startIdx+i);t<this.startIdx||t>this.endIdx||(t=this.data[t])&&(s="<span>"+this.dateformat(t[0])+"</span></br><span>시가 : "+afc.addComma(t[1])+'</span><span style="margin-left:20px;">고가 : '+afc.addComma(t[2])+"</span></br><span>저가 : "+afc.addComma(t[3])+'</span><span style="margin-left:20px;">종가 : '+afc.addComma(t[4])+"</span>",t[5]&&(s+="</br><span>거래량 : "+afc.addComma(t[5])+"</span>"),t[6]&&(s+="</br><span>거래대금 : "+afc.addComma(t[6])+"</span>"),this.infoDiv.innerHTML=s,this.longXdiv.style.left=this.startLineX-i*this.pos.barTot-1+"px",this.longYdiv.style.top=this.pos.upGrpSY+(this.upGrpMaxAm-t[4])*this.pos.upRateH+"px")},EXJisooChart.prototype.autoScroll=function(t){var s=this;150<t||!this.isExistNextData()||(this.timer=setTimeout(function(){s.timer=null,s.mScrollLR?s.scrollLToR(1):s.scrollRToL(1),s.autoScroll(t+t/4)},t))},EXJisooChart.prototype.setTouchEvent=function(){var o,a,h,e,r,p,n=this,l=!1;AEvent.bindEvent(this.canvas,AEvent.ACTION_DOWN,function(t){l=!0,n.data&&0!=n.data.length&&(t.preventDefault(),t.stopPropagation(),o=t.targetTouches[0],a=t.targetTouches[1],h=o.pageX,n.timer&&(clearTimeout(n.timer),n.timer=null),n.scollSX=h,n.mStartTime=(new Date).getTime(),n.mOldTime=n.mStartTime,n.mStartX=h,n.mEndX=n.mStartX,this.longTime=setTimeout(function(){a||(n.mode=1,n.infoDiv.style.display="",n.longXdiv.style.display="",n.longYdiv.style.display="",n.moveX=h,n.drawLongTabLines())},500))}),AEvent.bindEvent(this.canvas,AEvent.ACTION_MOVE,function(t){var s,i;clearTimeout(this.longTime),l&&n.data&&0!=n.data.length&&(t.preventDefault(),t.stopPropagation(),o=t.targetTouches[0],a=t.targetTouches[1],h=o.pageX,e=o.pageY,a?(r=a.pageX,p=a.pageY,o&&a&&(t={x:h,y:e},i={x:r,y:p},i=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),n.lastDist||(n.lastDist=i),n.rateVal=(i/n.lastDist).toFixed(2),n.zoomState=0,n.zoomInOut(),n.lastDist=i)):1==n.mode?(n.moveX=h,n.drawLongTabLines()):(100<(t=(new Date).getTime())-n.mOldTime?(n.mStartTime=t,n.mOldTime=t,n.mStartX=h,n.mEndX=n.mStartX):(n.mOldTime=t,n.mEndX=h),(i=Math.abs(n.scollSX-h))>n.pos.barW&&(n.scollSX>h?(n.mScrollLR=!1,s=parseInt(i/n.pos.barW,10),n.scrollRToL(s)):(n.mScrollLR=!0,s=parseInt(i/n.pos.barW,10),n.scrollLToR(s)),n.scollSX=h)))}),AEvent.bindEvent(this.canvas,AEvent.ACTION_UP,function(t){l=!1,n.data&&0!=n.data.length&&(clearTimeout(this.longTime),n.mode=0,n.infoDiv&&(n.infoDiv.style.display="none",n.longXdiv.style.display="none",n.longYdiv.style.display="none"),t.preventDefault(),t.stopPropagation(),t=(new Date).getTime()-n.mStartTime,n.speed=Math.abs(n.mEndX-n.mStartX)/t,.5<n.speed&&n.autoScroll((4-n.speed)/2),n.lastDist=null)})},EXJisooChart.prototype.addNewData=function(t,s){if(t){if(this.startId--,!s){var i=t.length;s=new Array;for(var o=0;o<i;o++)s.push(o)}for(var a=new Array,o=0;o<t.length;o++)a.push(t[s[o]]);this.data.unshift([t[s[0]],t[s[1]]/this.divisionVal,t[s[2]]/this.divisionVal,t[s[3]]/this.divisionVal,t[s[4]]/this.divisionVal,t[s[5]]/this.divisionVal,t[s[6]]/this.divisionVal]),this.updateGraph(),1==this.mode&&this.drawLongTabLines()}},EXJisooChart.prototype.drawLongTabLines=function(){var t=this._getMiddleX();this.isShowLeft?t>this.moveX&&(this.infoDiv.style.left="",this.infoDiv.style.right="10px",this.isShowLeft=!1):t<this.moveX&&(this.infoDiv.style.right="",this.infoDiv.style.left="10px",this.isShowLeft=!0),this.drawLongTabData(this.moveX)},EXJisooChart.prototype.setLongtabLineColor=function(t){this.longXdiv.style.background=t,this.longYdiv.style.background=t},EXJisooChart.prototype.getLongtabLineColor=function(t){return this.longXdiv.style.background},EXJisooChart.prototype.getQueryData=function(t,s){},EXJisooChart.prototype.getMappingCount=function(){return["Date","Start Price","High Price","Low Price","End Price","Trade Qty","Trade Price"]},EXJisooChart.prototype.setQueryData=function(t,s,i){for(var o,a=0;a<t.length;a++)o=t[a],this.data.push([o[s[0]],o[s[1]]/this.divisionVal,o[s[2]]/this.divisionVal,o[s[3]]/this.divisionVal,o[s[4]]/this.divisionVal,o[s[5]]/this.divisionVal,o[s[6]]/this.divisionVal]);this.updateGraph()}}();